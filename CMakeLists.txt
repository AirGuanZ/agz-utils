CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

PROJECT(AGZM)

SET(CMAKE_CXX_STANDARD 17)

IF(MSVC)
    ADD_DEFINITIONS(-D_CRT_SECURE_NO_WARNINGS)
ENDIF()

IF("${CMAKE_CXX_COMPILER_ID}" STREQUAL "Clang")
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++ -pthread")
    SET(STDFS_LD_LIB "c++fs")
ELSEIF("${CMAKE_CXX_COMPILER_ID}" STREQUAL "GNU")
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -pthread")
    SET(STDFS_LD_LIB "stdc++fs")
ENDIF()

ADD_SUBDIRECTORY(src/)

FILE(GLOB_RECURSE SRC "include/*.h" "include/*.inl" "test/*.cpp")
ADD_EXECUTABLE(Test ${SRC})
FOREACH(_SRC IN ITEMS ${SRC})
    GET_FILENAME_COMPONENT(SRC "${_SRC}" PATH)
    STRING(REPLACE "${CMAKE_CURRENT_SOURCE_DIR}" "" _GRP_PATH "${SRC}")
    STRING(REPLACE "/" "\\" _GRP_PATH "${_GRP_PATH}")
    SOURCE_GROUP("${_GRP_PATH}" FILES "${_SRC}")
ENDFOREACH()

TARGET_INCLUDE_DIRECTORIES(Test PRIVATE ${AGZUtils_INCLUDE_DIRS})
TARGET_LINK_LIBRARIES(Test AGZUtils)
